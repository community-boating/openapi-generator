openapi: 3.0.0
info:
  version: '1'
  title: ''
  description: ''
paths: {}
components:
  securitySchemes: {}
  schemas:
    Catalog:
      required: [id]
      properties:
        id:
          type: integer
          format: int64
        startActive:
          type: string
          format: date-time
        endActive:
          type: string
          format: date-time
        catalogName:
          type: string
          maxLength: 200
    Product:
      required: [id, productName, productDescription, active, catalogId]
      properties:
        id:
          type: integer
          format: int64
        productName:
          type: string
          maxLength: 200
        productDescription:
          type: string
          maxLength: 500
        active:
          type: boolean
        catalogId:
          $ref: '#/components/schemas/Catalog'

    Item:
      required: [id, type]
      properties:
        id:
          type: integer
          format: int64
        itemType:
          $ref: './shared.yaml#/components/schemas/ItemType'
        classTypeId:
          $ref: '#/components/schemas/ApClassType'
        classInstanceId:
          $ref: '#/components/schemas/ApClassInstance'
        membershipTypeId:
          $ref: '#/components/schemas/MembershipType'
        productId:
          $ref: '#/components/schemas/Product'
        itemName:
          type: string
          maxLength: 200
        itemDescription:
          type: string
          maxLength: 500
        imageURL:
          type: string
          maxLength: 200
        itemSKU:
          nullable: true
          type: string
          maxLength: 500
        minQuantity:
          type: integer
        maxQuantity:
          type: integer
        allowPriceOverride:
          type: boolean
        priceOverrideMin:
          type: integer
          format: int64
        priceOverrideMax:
          type: integer
          format: int64
        squareItemId:
          type: string
          maxLength: 200
        catalogId:
          $ref: '#/components/schemas/Catalog'

    DiscountCategory:
      required: [id, discountId]
      properties:
        id:
          type: integer
          format: int64
        discountId:
          $ref: '#/components/schemas/Discount'
        categoryId:
          $ref: '#/components/schemas/Category'


    ItemCategory:
      required: [id, item, categoryId]
      properties:
        id:
          type: integer
          format: int64
        item:
          $ref: '#/components/schemas/Item'
        categoryId:
          $ref: '#/components/schemas/Category'

    Category:
      required: [id, categoryName, description, catalogId]
      properties:
        id:
          type: integer
          format: int64
        categoryName:
          type: string
          maxLength: 200
        description:
          type: string
          maxLength: 500
        categoryType:
          $ref: './shared.yaml#/components/schemas/CategoryType'
        catalogId:
          $ref: '#/components/schemas/Catalog'

    ItemInstance:
      required: [id, itemId]
      properties:
        id:
          type: integer
          format: int64
        itemId:
          $ref: '#/components/schemas/Item'
        priceCents:
          type: integer
          format: int64
        startActive:
          type: string
          format: date-time
        endActive:
          type: string
          format: date-time
    
    ItemInstanceStockChange:
      required: [itemInstanceId, changeAmount, stockChangeType]
      properties:
        id:
          type: integer
          format: int64
        itemInstanceId:
          $ref: '#/components/schemas/ItemInstance'
        lineItem:
          $ref: '#/components/schemas/LineItem'
        changeAmount:
          type: integer
        stockChangeType:
          $ref: './shared.yaml#/components/schemas/StockChangeType'
        purchasableState:
          $ref: './shared.yaml#/components/schemas/PurchasableState'

    LineItem:
      required: [id, orderId, itemInstanceId, itemPriceCents]
      properties:
        id:
          type: integer
          format: int64
        referenceId:
          type: string
          maxLength: 200
        parentItemId:
          $ref: '#/components/schemas/LineItem'
        orderId:
          $ref: '#/components/schemas/OrderNew'
        itemInstanceId:
          $ref: '#/components/schemas/ItemInstance'
        subscriptionId:
          $ref: '#/components/schemas/PersonSubscription'
        amountBaseCents:
          description: Base cost of a single unit of this line item (From catalog or amount specified, if allowed)
          type: integer
          format: int64
        amountSpecifiedCents:
          description: Specified cost of a single unit of this line item(For catalog items that support variable pricing)
          type: integer
          format: int64
        amountPaidCents:
          description: Amount of money successfully paid
          type: integer
          format: int64
        deleted:
          type: boolean

    LineItemRefund:
      properties:
        id:
          type: integer
          format: int64
        lineItemId:
          $ref: '#/components/schemas/LineItem'
        stockChangeId:
          $ref: '#/components/schemas/ItemInstanceStockChange'
        amountToRefundUnitCents:
          type: integer
          format: int64
        amountRefundedCents:
          type: integer
          format: int64
        refundQuantity:
          type: integer
        returnStock:
          type: boolean
        revokeAfter:
          type: boolean
        revokeDuring:
          type: boolean
    LineItemRefundTax:
      required: [taxId]
      properties:
        id:
          type: integer
          format: int64
        lineItemRefundId:
          $ref: '#/components/schemas/LineItemRefund'
        taxId:
          type: integer
          format: int64

    ItemTax:
      required: [id, itemId, taxId]
      properties:
        id:
          type: integer
          format: int64
        itemId:
          $ref: '#/components/schemas/Item'
        taxId:
          $ref: '#/components/schemas/Tax'

    Tax:
      required: [id, taxName, taxRate, taxMinValueCents, catalogId]
      properties:
        id:
          type: integer
          format: int64
        taxName:
          type: string
          maxLength: 200
        taxCode:
          type: string
          maxLength: 500
        taxRate:
          type: string
          maxLength: 200
        taxMinValueCents:
          type: integer
          format: int64
        taxBeforeDiscount:
          type: boolean
        catalogId:
          $ref: '#/components/schemas/Catalog'
    
    OrderTax:
      required: [id, taxId, orderNew]
      properties:
        id:
          type: integer
          format: int64
        taxId:
          $ref: '#/components/schemas/Tax'
        order:
          $ref: '#/components/schemas/OrderNew'
        amountTotalCents:
          type: integer
          format: int64
        amountPaidCents:
          type: integer
          format: int64
        amountRefundedCents:
          type: integer
          format: int64
        amountToRefundCents:
          type: integer
          format: int64
        taxRateUsed:
          type: string
          maxLength: 200

    LineItemDiscountInstance:
      required: [id, lineItemId, discountInstanceId, discountType]
      properties:
        id:
          type: integer
          format: int64
        lineItemId:
          $ref: '#/components/schemas/LineItem'
        discountInstanceId:
          $ref: '#/components/schemas/DiscountInstance'
        isApplied:
          type: boolean
        discountType:
          $ref: './shared.yaml#/components/schemas/DiscountType'
        specifiedCents:
          type: integer
          format: int64
        specifiedPercent:
          type: string
          format: int64
        amountBaseCents:
          type: integer
          format: int64
        amountTotalCents:
          type: integer
          format: int64
        universalCode:
          type: string
          maxLength: 100

    OrderNew:
      type: object
      required: [orderId, status, version]
      properties:
        id:
          type: integer
          format: int64
        orderSource:
          $ref: './shared.yaml#/components/schemas/OrderSource'
        amountBaseCents:
          type: integer
          format: int64
        amountDiscountsCents:
          type: integer
          format: int64
        amountTaxesCents:
          type: integer
          format: int64
        amountTotalCents:
          type: integer
          format: int64
        amountPaidCents:
          type: integer
          format: int64
        #itemCount:
        #  type: integer
        version:
          type: integer
        orderStatus:
          $ref: './shared.yaml#/components/schemas/OrderStateNew'
        personId:
          $ref: '#/components/schemas/Person'
        deleted:
          type: boolean

    ItemDiscount:
      required: [id, itemId, discountId]
      properties:
        id:
          type: integer
          format: int64
        itemId:
          $ref: '#/components/schemas/Item'
        requiresParentEligibility:
          type: boolean
        discountType:
          $ref: './shared.yaml#/components/schemas/DiscountType'
        amountCents:
          type: integer
          format: int64
        percent:
          type: string
        discountId:
          $ref: '#/components/schemas/Discount'
    PaymentSource:
      properties:
        id:
          type: integer
          format: int64
        personId:
          $ref: '#/components/schemas/Person'
        paymentType:
          $ref: './shared.yaml#/components/schemas/PaymentType'
        stripePaymentSource:
          type: string
          maxLength: 500
        balanceSource:
          $ref: '#/components/schemas/Balance'
        active:
          type: boolean

        
    OrderPayment:
      required: [id, orderId, paymentType, paymentSource, paymentAmountCents, paymentStatus]
      properties:
        id:
          type: integer
          format: int64
        orderId:
          $ref: '#/components/schemas/OrderNew'
        paymentType:
          $ref: './shared.yaml#/components/schemas/PaymentType'
        paymentSource:
          type: string
          maxLength: 100
        paymentServiceChangeCents:
          type: integer
          format: int64
        paymentPaidCents:
          type: integer
          format: int64
        paymentTotalCents:
          type: integer
          format: int64
        paymentRefundedCents:
          type: integer
          format: int64
        paymentToRefundCents:
          type: integer
          format: int64
        paymentStatus:
          $ref: './shared.yaml#/components/schemas/PaymentStatus'
        paymentDueDate:
          type: string
          format: date-time

    BalanceTransaction:
      required: [id, balanceId, transactionAmountCents]
      properties:
        id:
          type: integer
          format: int64
        balanceId:
          $ref: '#/components/schemas/Balance'
        balanceTransactionType:
          $ref: './shared.yaml#/components/schemas/BalanceTransactionType'
        paymentId:
          $ref: '#/components/schemas/OrderPayment'
        transactionAmountCents:
          type: integer
          format: int64
        purchasableState:
          $ref: './shared.yaml#/components/schemas/PurchasableState'
        lineItemId:
          $ref: '#/components/schemas/LineItem'

    Balance:
      required: [id, balanceCents, balanceType]
      properties:
        id:
          type: integer
          format: int64
        balanceAccountNumber:
          type: string
        balanceAccountToken:
          type: string
          maxLength: 64
          minLength: 64
        balanceType:
          $ref: './shared.yaml#/components/schemas/BalanceType'
        balanceOwner:
          $ref: '#/components/schemas/Person'

    StripeTransaction:
      required: [id, stripePaymentIntent, transactionAmountCents]
      properties:
        id:
          type: integer
          format: int64
        transactionType:
          $ref: './shared.yaml#/components/schemas/StripeTransactionType'
        stripePaymentIntent:
          type: string
          maxLength: 500
        transactionAmountCents:
          type: integer
          format: int64
        paymentId:
          $ref: '#/components/schemas/OrderPayment'

    CashTransaction:
      required: [id, cashDrawerId, transactionAmountCents]
      properties:
        id:
          type: integer
          format: int64
        cashDrawerId:
          $ref: '#/components/schemas/CashDrawer'
        transactionAmountCents:
          type: integer
          format: int64
        paymentId:
          $ref: '#/components/schemas/OrderPayment'
        cashDrawerChangeId:
          $ref: '#/components/schemas/CashDrawersChange'

    CashDrawersChange:
      required: [id, changeType, changeAmountCents]
      properties:
        id:
          type: integer
        changeType:
          type: string
          maxLength: 50
        changeAmountCents:
          type: integer
          format: int64
    ApClassType:
      x-already-exists: true
      required: [id]
      properties:
        id:
          type: integer

    ApClassInstance:
      x-already-exists: true
      required: [id]
      properties:
        id:
          type: integer

    PersonSubscription:
      required: [id, personId, subscriptionId, billingCycle]
      properties:
        id:
          type: integer
          format: int64
        personId:
          $ref: '#/components/schemas/Person'
        subscriptionId:
          $ref: '#/components/schemas/Subscription'
        billingDate:
          type: string
          format: date
        billingCycle:
          type: string
          maxLength: 50

    Subscription:
      required: [id, name, billingCycle]
      properties:
        id:
          type: integer
          format: int64
        name:
          type: string
          maxLength: 200
        billingCycle:
          type: string
          maxLength: 50

    SubscriptionItem:
      required: [id, subscriptionId, itemId]
      properties:
        id:
          type: integer
          format: int64
        subscriptionId:
          $ref: '#/components/schemas/Subscription'
        itemId:
          $ref: '#/components/schemas/Item'
        cyclePriceOverrideCents:
          type: integer
          format: int64
    PersonPhone:
      type: object
      required: [phoneId, personId, assignId]
      properties:
        assignId:
          type: integer
          format: int64
        isPrimary:
          type: boolean
        startActive:
          type: string
          format: date-time
        endActive:
          type: string
          format: date-time
        name:
          type: string
          maxLength: 100
        personId:
          $ref: '#/components/schemas/Person'
        phoneId:
          $ref: '#/components/schemas/Phone'
    Phone:
      type: object
      required: [assignId, number]
      properties:
        assignId:
          type: integer
          format: int64
        number:
          x-dto-column: ""
          type: string
          maxLength: 100
          pattern: ^[\+]?[(]?[0-9]{3}[)]?[-\s\.]?[0-9]{3}[-\s\.]?[0-9]{4,6}$
        type:
          $ref: './shared.yaml#/components/schemas/PhoneType'
        isVerified:
          type: boolean
        isBad:
          type: boolean
    PersonAddress:
      type: object
      required: [personId, addressId, assignId]
      properties:
        assignId:
          type: integer
          format: int64
        startActive:
          type: string
          format: date-time
        endActive:
          type: string
          format: date-time
        name:
          type: string
          maxLength: 100
        isPrimary:
          type: boolean
        addressId:
          $ref: '#/components/schemas/Address'
        personId:
          $ref: '#/components/schemas/Person'
    Address:
      type: object
      required: [id, line1, state, country, zip]
      properties:
        id:
          type: integer
          format: int64
        isVerified:
          type: boolean
        isBad:
          type: boolean
        line1:
          type: string
          maxLength: 200
          minLength: 1
        line2:
          x-dto-column: ADDR_2
          type: string
          maxLength: 200
        line3:
          x-dto-column: ADDR_3
          type: string
          maxLength: 200
        state:
          type: string
          maxLength: 50
          minLength: 2
        city:
          type: string
          maxLength: 50
        country:
          type: string
          maxLength: 50
        zip:
          type: string
          maxLength: 15

    MembershipType:
      x-already-exists: true
      required: [id]
      properties:
        id:
          type: integer

    Person:
      x-already-exists: true
      required: [id]
      properties:
        id:
          type: integer

    DiscountInstance:
      x-already-exists: true
      required: [id]
      properties:
        id:
          type: integer

    Discount:
      x-already-exists: true
      required: [id]
      properties:
        id:
          type: integer

    CashDrawer:
      x-already-exists: true
      required: [cashDrawerId]
      properties:
        cashDrawerId:
          type: integer